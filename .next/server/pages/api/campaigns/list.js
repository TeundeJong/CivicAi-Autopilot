"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/campaigns/list";
exports.ids = ["pages/api/campaigns/list"];
exports.modules = {

/***/ "@supabase/supabase-js":
/*!****************************************!*\
  !*** external "@supabase/supabase-js" ***!
  \****************************************/
/***/ ((module) => {

module.exports = require("@supabase/supabase-js");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fcampaigns%2Flist&preferredRegion=&absolutePagePath=.%2Fsrc%5Cpages%5Capi%5Ccampaigns%5Clist.js&middlewareConfigBase64=e30%3D!":
/*!********************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fcampaigns%2Flist&preferredRegion=&absolutePagePath=.%2Fsrc%5Cpages%5Capi%5Ccampaigns%5Clist.js&middlewareConfigBase64=e30%3D! ***!
  \********************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _src_pages_api_campaigns_list_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src\\pages\\api\\campaigns\\list.js */ \"(api)/./src/pages/api/campaigns/list.js\");\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_src_pages_api_campaigns_list_js__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_src_pages_api_campaigns_list_js__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/campaigns/list\",\n        pathname: \"/api/campaigns/list\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _src_pages_api_campaigns_list_js__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRmNhbXBhaWducyUyRmxpc3QmcHJlZmVycmVkUmVnaW9uPSZhYnNvbHV0ZVBhZ2VQYXRoPS4lMkZzcmMlNUNwYWdlcyU1Q2FwaSU1Q2NhbXBhaWducyU1Q2xpc3QuanMmbWlkZGxld2FyZUNvbmZpZ0Jhc2U2ND1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ0w7QUFDMUQ7QUFDa0U7QUFDbEU7QUFDQSxpRUFBZSx3RUFBSyxDQUFDLDZEQUFRLFlBQVksRUFBQztBQUMxQztBQUNPLGVBQWUsd0VBQUssQ0FBQyw2REFBUTtBQUNwQztBQUNPLHdCQUF3QixnSEFBbUI7QUFDbEQ7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsWUFBWTtBQUNaLENBQUM7O0FBRUQiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jaXZpY2FpLWF1dG9waWxvdC8/NjI2OCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQYWdlc0FQSVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvcGFnZXMtYXBpL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IGhvaXN0IH0gZnJvbSBcIm5leHQvZGlzdC9idWlsZC90ZW1wbGF0ZXMvaGVscGVyc1wiO1xuLy8gSW1wb3J0IHRoZSB1c2VybGFuZCBjb2RlLlxuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi4vc3JjXFxcXHBhZ2VzXFxcXGFwaVxcXFxjYW1wYWlnbnNcXFxcbGlzdC5qc1wiO1xuLy8gUmUtZXhwb3J0IHRoZSBoYW5kbGVyIChzaG91bGQgYmUgdGhlIGRlZmF1bHQgZXhwb3J0KS5cbmV4cG9ydCBkZWZhdWx0IGhvaXN0KHVzZXJsYW5kLCBcImRlZmF1bHRcIik7XG4vLyBSZS1leHBvcnQgY29uZmlnLlxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IGhvaXN0KHVzZXJsYW5kLCBcImNvbmZpZ1wiKTtcbi8vIENyZWF0ZSBhbmQgZXhwb3J0IHRoZSByb3V0ZSBtb2R1bGUgdGhhdCB3aWxsIGJlIGNvbnN1bWVkLlxuZXhwb3J0IGNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IFBhZ2VzQVBJUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLlBBR0VTX0FQSSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2NhbXBhaWducy9saXN0XCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvY2FtcGFpZ25zL2xpc3RcIixcbiAgICAgICAgLy8gVGhlIGZvbGxvd2luZyBhcmVuJ3QgdXNlZCBpbiBwcm9kdWN0aW9uLlxuICAgICAgICBidW5kbGVQYXRoOiBcIlwiLFxuICAgICAgICBmaWxlbmFtZTogXCJcIlxuICAgIH0sXG4gICAgdXNlcmxhbmRcbn0pO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1wYWdlcy1hcGkuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fcampaigns%2Flist&preferredRegion=&absolutePagePath=.%2Fsrc%5Cpages%5Capi%5Ccampaigns%5Clist.js&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./src/lib/db.js":
/*!***********************!*\
  !*** ./src/lib/db.js ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   addLeads: () => (/* binding */ addLeads),\n/* harmony export */   createCampaign: () => (/* binding */ createCampaign),\n/* harmony export */   getCampaign: () => (/* binding */ getCampaign),\n/* harmony export */   getPendingEmails: () => (/* binding */ getPendingEmails),\n/* harmony export */   listCalendarItems: () => (/* binding */ listCalendarItems),\n/* harmony export */   listCampaigns: () => (/* binding */ listCampaigns),\n/* harmony export */   listContentItems: () => (/* binding */ listContentItems),\n/* harmony export */   listEmailTemplates: () => (/* binding */ listEmailTemplates),\n/* harmony export */   listLeads: () => (/* binding */ listLeads),\n/* harmony export */   markEmailAsSent: () => (/* binding */ markEmailAsSent),\n/* harmony export */   saveContentItems: () => (/* binding */ saveContentItems),\n/* harmony export */   saveEmailTemplates: () => (/* binding */ saveEmailTemplates),\n/* harmony export */   scheduleEmails: () => (/* binding */ scheduleEmails)\n/* harmony export */ });\n/* harmony import */ var _supabaseAdmin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./supabaseAdmin */ \"(api)/./src/lib/supabaseAdmin.js\");\n\n/**\n * Simple DB helper functions using Supabase.\n */ async function createCampaign({ name, niche, target_description, offer, tone }) {\n    const supabase = (0,_supabaseAdmin__WEBPACK_IMPORTED_MODULE_0__.getSupabaseAdmin)();\n    const { data, error } = await supabase.from(\"campaigns\").insert([\n        {\n            name,\n            niche,\n            target_description,\n            offer,\n            tone\n        }\n    ]).select().single();\n    if (error) throw error;\n    return data;\n}\nasync function listCampaigns() {\n    const supabase = (0,_supabaseAdmin__WEBPACK_IMPORTED_MODULE_0__.getSupabaseAdmin)();\n    const { data, error } = await supabase.from(\"campaigns\").select(\"*\").order(\"created_at\", {\n        ascending: false\n    });\n    if (error) throw error;\n    return data || [];\n}\nasync function getCampaign(id) {\n    const supabase = (0,_supabaseAdmin__WEBPACK_IMPORTED_MODULE_0__.getSupabaseAdmin)();\n    const { data, error } = await supabase.from(\"campaigns\").select(\"*\").eq(\"id\", id).single();\n    if (error) throw error;\n    return data;\n}\nasync function saveEmailTemplates(campaign_id, templates) {\n    const supabase = (0,_supabaseAdmin__WEBPACK_IMPORTED_MODULE_0__.getSupabaseAdmin)();\n    const rows = Object.entries(templates).map(([type, tpl])=>({\n            campaign_id,\n            type,\n            subject: tpl.subject,\n            body: tpl.body\n        }));\n    const { data, error } = await supabase.from(\"email_templates\").insert(rows).select();\n    if (error) throw error;\n    return data;\n}\nasync function listEmailTemplates(campaign_id) {\n    const supabase = (0,_supabaseAdmin__WEBPACK_IMPORTED_MODULE_0__.getSupabaseAdmin)();\n    const { data, error } = await supabase.from(\"email_templates\").select(\"*\").eq(\"campaign_id\", campaign_id).order(\"created_at\", {\n        ascending: true\n    });\n    if (error) throw error;\n    return data || [];\n}\nasync function addLeads(campaign_id, leads) {\n    const supabase = (0,_supabaseAdmin__WEBPACK_IMPORTED_MODULE_0__.getSupabaseAdmin)();\n    const rows = leads.map((l)=>({\n            campaign_id,\n            name: l.name || null,\n            company: l.company || null,\n            email: l.email,\n            extra_data: l.extra_data || null\n        }));\n    const { data, error } = await supabase.from(\"leads\").insert(rows).select();\n    if (error) throw error;\n    return data;\n}\nasync function listLeads(campaign_id) {\n    const supabase = (0,_supabaseAdmin__WEBPACK_IMPORTED_MODULE_0__.getSupabaseAdmin)();\n    const { data, error } = await supabase.from(\"leads\").select(\"*\").eq(\"campaign_id\", campaign_id).order(\"created_at\", {\n        ascending: true\n    });\n    if (error) throw error;\n    return data || [];\n}\nasync function scheduleEmails({ campaign_id, template_ids, send_from, max_per_run = 50 }) {\n    const supabase = (0,_supabaseAdmin__WEBPACK_IMPORTED_MODULE_0__.getSupabaseAdmin)();\n    const { data: leads, error: leadErr } = await supabase.from(\"leads\").select(\"*\").eq(\"campaign_id\", campaign_id);\n    if (leadErr) throw leadErr;\n    const { data: templates, error: tplErr } = await supabase.from(\"email_templates\").select(\"*\").in(\"id\", template_ids);\n    if (tplErr) throw tplErr;\n    const scheduledRows = [];\n    let offsetMinutes = 0;\n    for (const lead of leads){\n        for (const tpl of templates){\n            const scheduled_for = new Date(new Date(send_from).getTime() + offsetMinutes * 60000).toISOString();\n            scheduledRows.push({\n                campaign_id,\n                lead_id: lead.id,\n                template_id: tpl.id,\n                scheduled_for,\n                status: \"pending\"\n            });\n            offsetMinutes += 2; // kleine delay tussen mails\n        }\n    }\n    if (!scheduledRows.length) return [];\n    const { data, error } = await supabase.from(\"scheduled_emails\").insert(scheduledRows).select();\n    if (error) throw error;\n    return data;\n}\nasync function getPendingEmails(limit = 20) {\n    const supabase = (0,_supabaseAdmin__WEBPACK_IMPORTED_MODULE_0__.getSupabaseAdmin)();\n    const nowIso = new Date().toISOString();\n    const { data, error } = await supabase.from(\"scheduled_emails\").select(\"*, leads(*), email_templates(*)\").eq(\"status\", \"pending\").lte(\"scheduled_for\", nowIso).order(\"scheduled_for\", {\n        ascending: true\n    }).limit(limit);\n    if (error) throw error;\n    return data || [];\n}\nasync function markEmailAsSent(id, provider_message_id) {\n    const supabase = (0,_supabaseAdmin__WEBPACK_IMPORTED_MODULE_0__.getSupabaseAdmin)();\n    const { data, error } = await supabase.from(\"scheduled_emails\").update({\n        status: \"sent\",\n        provider_message_id\n    }).eq(\"id\", id).select().single();\n    if (error) throw error;\n    return data;\n}\n/** Content items for generator + calendar **/ async function saveContentItems(campaign_id, items) {\n    const supabase = (0,_supabaseAdmin__WEBPACK_IMPORTED_MODULE_0__.getSupabaseAdmin)();\n    const rows = items.map((it)=>({\n            campaign_id,\n            type: it.type,\n            title: it.title,\n            body: it.body,\n            scheduled_for: it.scheduled_for || null\n        }));\n    const { data, error } = await supabase.from(\"content_items\").insert(rows).select();\n    if (error) throw error;\n    return data;\n}\nasync function listContentItems(campaign_id) {\n    const supabase = (0,_supabaseAdmin__WEBPACK_IMPORTED_MODULE_0__.getSupabaseAdmin)();\n    const { data, error } = await supabase.from(\"content_items\").select(\"*\").eq(\"campaign_id\", campaign_id).order(\"scheduled_for\", {\n        ascending: true\n    });\n    if (error) throw error;\n    return data || [];\n}\nasync function listCalendarItems() {\n    const supabase = (0,_supabaseAdmin__WEBPACK_IMPORTED_MODULE_0__.getSupabaseAdmin)();\n    const { data: emails, error: emailsErr } = await supabase.from(\"scheduled_emails\").select(\"id, scheduled_for, status, leads(email), email_templates(subject)\").order(\"scheduled_for\", {\n        ascending: true\n    });\n    if (emailsErr) throw emailsErr;\n    const { data: content, error: contentErr } = await supabase.from(\"content_items\").select(\"*\").order(\"scheduled_for\", {\n        ascending: true\n    });\n    if (contentErr) throw contentErr;\n    return {\n        emails,\n        content\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9zcmMvbGliL2RiLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQW1EO0FBRW5EOztDQUVDLEdBRU0sZUFBZUMsZUFBZSxFQUFFQyxJQUFJLEVBQUVDLEtBQUssRUFBRUMsa0JBQWtCLEVBQUVDLEtBQUssRUFBRUMsSUFBSSxFQUFFO0lBQ25GLE1BQU1DLFdBQVdQLGdFQUFnQkE7SUFDakMsTUFBTSxFQUFFUSxJQUFJLEVBQUVDLEtBQUssRUFBRSxHQUFHLE1BQU1GLFNBQzNCRyxJQUFJLENBQUMsYUFDTEMsTUFBTSxDQUFDO1FBQUM7WUFBRVQ7WUFBTUM7WUFBT0M7WUFBb0JDO1lBQU9DO1FBQUs7S0FBRSxFQUN6RE0sTUFBTSxHQUNOQyxNQUFNO0lBQ1QsSUFBSUosT0FBTyxNQUFNQTtJQUNqQixPQUFPRDtBQUNUO0FBRU8sZUFBZU07SUFDcEIsTUFBTVAsV0FBV1AsZ0VBQWdCQTtJQUNqQyxNQUFNLEVBQUVRLElBQUksRUFBRUMsS0FBSyxFQUFFLEdBQUcsTUFBTUYsU0FDM0JHLElBQUksQ0FBQyxhQUNMRSxNQUFNLENBQUMsS0FDUEcsS0FBSyxDQUFDLGNBQWM7UUFBRUMsV0FBVztJQUFNO0lBQzFDLElBQUlQLE9BQU8sTUFBTUE7SUFDakIsT0FBT0QsUUFBUSxFQUFFO0FBQ25CO0FBRU8sZUFBZVMsWUFBWUMsRUFBRTtJQUNsQyxNQUFNWCxXQUFXUCxnRUFBZ0JBO0lBQ2pDLE1BQU0sRUFBRVEsSUFBSSxFQUFFQyxLQUFLLEVBQUUsR0FBRyxNQUFNRixTQUMzQkcsSUFBSSxDQUFDLGFBQ0xFLE1BQU0sQ0FBQyxLQUNQTyxFQUFFLENBQUMsTUFBTUQsSUFDVEwsTUFBTTtJQUNULElBQUlKLE9BQU8sTUFBTUE7SUFDakIsT0FBT0Q7QUFDVDtBQUVPLGVBQWVZLG1CQUFtQkMsV0FBVyxFQUFFQyxTQUFTO0lBQzdELE1BQU1mLFdBQVdQLGdFQUFnQkE7SUFDakMsTUFBTXVCLE9BQU9DLE9BQU9DLE9BQU8sQ0FBQ0gsV0FBV0ksR0FBRyxDQUFDLENBQUMsQ0FBQ0MsTUFBTUMsSUFBSSxHQUFNO1lBQzNEUDtZQUNBTTtZQUNBRSxTQUFTRCxJQUFJQyxPQUFPO1lBQ3BCQyxNQUFNRixJQUFJRSxJQUFJO1FBQ2hCO0lBQ0EsTUFBTSxFQUFFdEIsSUFBSSxFQUFFQyxLQUFLLEVBQUUsR0FBRyxNQUFNRixTQUMzQkcsSUFBSSxDQUFDLG1CQUNMQyxNQUFNLENBQUNZLE1BQ1BYLE1BQU07SUFDVCxJQUFJSCxPQUFPLE1BQU1BO0lBQ2pCLE9BQU9EO0FBQ1Q7QUFFTyxlQUFldUIsbUJBQW1CVixXQUFXO0lBQ2xELE1BQU1kLFdBQVdQLGdFQUFnQkE7SUFDakMsTUFBTSxFQUFFUSxJQUFJLEVBQUVDLEtBQUssRUFBRSxHQUFHLE1BQU1GLFNBQzNCRyxJQUFJLENBQUMsbUJBQ0xFLE1BQU0sQ0FBQyxLQUNQTyxFQUFFLENBQUMsZUFBZUUsYUFDbEJOLEtBQUssQ0FBQyxjQUFjO1FBQUVDLFdBQVc7SUFBSztJQUN6QyxJQUFJUCxPQUFPLE1BQU1BO0lBQ2pCLE9BQU9ELFFBQVEsRUFBRTtBQUNuQjtBQUVPLGVBQWV3QixTQUFTWCxXQUFXLEVBQUVZLEtBQUs7SUFDL0MsTUFBTTFCLFdBQVdQLGdFQUFnQkE7SUFDakMsTUFBTXVCLE9BQU9VLE1BQU1QLEdBQUcsQ0FBQ1EsQ0FBQUEsSUFBTTtZQUMzQmI7WUFDQW5CLE1BQU1nQyxFQUFFaEMsSUFBSSxJQUFJO1lBQ2hCaUMsU0FBU0QsRUFBRUMsT0FBTyxJQUFJO1lBQ3RCQyxPQUFPRixFQUFFRSxLQUFLO1lBQ2RDLFlBQVlILEVBQUVHLFVBQVUsSUFBSTtRQUM5QjtJQUNBLE1BQU0sRUFBRTdCLElBQUksRUFBRUMsS0FBSyxFQUFFLEdBQUcsTUFBTUYsU0FDM0JHLElBQUksQ0FBQyxTQUNMQyxNQUFNLENBQUNZLE1BQ1BYLE1BQU07SUFDVCxJQUFJSCxPQUFPLE1BQU1BO0lBQ2pCLE9BQU9EO0FBQ1Q7QUFFTyxlQUFlOEIsVUFBVWpCLFdBQVc7SUFDekMsTUFBTWQsV0FBV1AsZ0VBQWdCQTtJQUNqQyxNQUFNLEVBQUVRLElBQUksRUFBRUMsS0FBSyxFQUFFLEdBQUcsTUFBTUYsU0FDM0JHLElBQUksQ0FBQyxTQUNMRSxNQUFNLENBQUMsS0FDUE8sRUFBRSxDQUFDLGVBQWVFLGFBQ2xCTixLQUFLLENBQUMsY0FBYztRQUFFQyxXQUFXO0lBQUs7SUFDekMsSUFBSVAsT0FBTyxNQUFNQTtJQUNqQixPQUFPRCxRQUFRLEVBQUU7QUFDbkI7QUFFTyxlQUFlK0IsZUFBZSxFQUFFbEIsV0FBVyxFQUFFbUIsWUFBWSxFQUFFQyxTQUFTLEVBQUVDLGNBQWMsRUFBRSxFQUFFO0lBQzdGLE1BQU1uQyxXQUFXUCxnRUFBZ0JBO0lBRWpDLE1BQU0sRUFBRVEsTUFBTXlCLEtBQUssRUFBRXhCLE9BQU9rQyxPQUFPLEVBQUUsR0FBRyxNQUFNcEMsU0FDM0NHLElBQUksQ0FBQyxTQUNMRSxNQUFNLENBQUMsS0FDUE8sRUFBRSxDQUFDLGVBQWVFO0lBQ3JCLElBQUlzQixTQUFTLE1BQU1BO0lBRW5CLE1BQU0sRUFBRW5DLE1BQU1jLFNBQVMsRUFBRWIsT0FBT21DLE1BQU0sRUFBRSxHQUFHLE1BQU1yQyxTQUM5Q0csSUFBSSxDQUFDLG1CQUNMRSxNQUFNLENBQUMsS0FDUGlDLEVBQUUsQ0FBQyxNQUFNTDtJQUNaLElBQUlJLFFBQVEsTUFBTUE7SUFFbEIsTUFBTUUsZ0JBQWdCLEVBQUU7SUFDeEIsSUFBSUMsZ0JBQWdCO0lBRXBCLEtBQUssTUFBTUMsUUFBUWYsTUFBTztRQUN4QixLQUFLLE1BQU1MLE9BQU9OLFVBQVc7WUFDM0IsTUFBTTJCLGdCQUFnQixJQUFJQyxLQUFLLElBQUlBLEtBQUtULFdBQVdVLE9BQU8sS0FBS0osZ0JBQWdCLE9BQU9LLFdBQVc7WUFDakdOLGNBQWNPLElBQUksQ0FBQztnQkFDakJoQztnQkFDQWlDLFNBQVNOLEtBQUs5QixFQUFFO2dCQUNoQnFDLGFBQWEzQixJQUFJVixFQUFFO2dCQUNuQitCO2dCQUNBTyxRQUFRO1lBQ1Y7WUFDQVQsaUJBQWlCLEdBQUcsNEJBQTRCO1FBQ2xEO0lBQ0Y7SUFFQSxJQUFJLENBQUNELGNBQWNXLE1BQU0sRUFBRSxPQUFPLEVBQUU7SUFFcEMsTUFBTSxFQUFFakQsSUFBSSxFQUFFQyxLQUFLLEVBQUUsR0FBRyxNQUFNRixTQUMzQkcsSUFBSSxDQUFDLG9CQUNMQyxNQUFNLENBQUNtQyxlQUNQbEMsTUFBTTtJQUNULElBQUlILE9BQU8sTUFBTUE7SUFDakIsT0FBT0Q7QUFDVDtBQUVPLGVBQWVrRCxpQkFBaUJDLFFBQVEsRUFBRTtJQUMvQyxNQUFNcEQsV0FBV1AsZ0VBQWdCQTtJQUNqQyxNQUFNNEQsU0FBUyxJQUFJVixPQUFPRSxXQUFXO0lBRXJDLE1BQU0sRUFBRTVDLElBQUksRUFBRUMsS0FBSyxFQUFFLEdBQUcsTUFBTUYsU0FDM0JHLElBQUksQ0FBQyxvQkFDTEUsTUFBTSxDQUFDLG1DQUNQTyxFQUFFLENBQUMsVUFBVSxXQUNiMEMsR0FBRyxDQUFDLGlCQUFpQkQsUUFDckI3QyxLQUFLLENBQUMsaUJBQWlCO1FBQUVDLFdBQVc7SUFBSyxHQUN6QzJDLEtBQUssQ0FBQ0E7SUFFVCxJQUFJbEQsT0FBTyxNQUFNQTtJQUNqQixPQUFPRCxRQUFRLEVBQUU7QUFDbkI7QUFFTyxlQUFlc0QsZ0JBQWdCNUMsRUFBRSxFQUFFNkMsbUJBQW1CO0lBQzNELE1BQU14RCxXQUFXUCxnRUFBZ0JBO0lBQ2pDLE1BQU0sRUFBRVEsSUFBSSxFQUFFQyxLQUFLLEVBQUUsR0FBRyxNQUFNRixTQUMzQkcsSUFBSSxDQUFDLG9CQUNMc0QsTUFBTSxDQUFDO1FBQ05SLFFBQVE7UUFDUk87SUFDRixHQUNDNUMsRUFBRSxDQUFDLE1BQU1ELElBQ1ROLE1BQU0sR0FDTkMsTUFBTTtJQUNULElBQUlKLE9BQU8sTUFBTUE7SUFDakIsT0FBT0Q7QUFDVDtBQUVBLDRDQUE0QyxHQUVyQyxlQUFleUQsaUJBQWlCNUMsV0FBVyxFQUFFNkMsS0FBSztJQUN2RCxNQUFNM0QsV0FBV1AsZ0VBQWdCQTtJQUNqQyxNQUFNdUIsT0FBTzJDLE1BQU14QyxHQUFHLENBQUN5QyxDQUFBQSxLQUFPO1lBQzVCOUM7WUFDQU0sTUFBTXdDLEdBQUd4QyxJQUFJO1lBQ2J5QyxPQUFPRCxHQUFHQyxLQUFLO1lBQ2Z0QyxNQUFNcUMsR0FBR3JDLElBQUk7WUFDYm1CLGVBQWVrQixHQUFHbEIsYUFBYSxJQUFJO1FBQ3JDO0lBQ0EsTUFBTSxFQUFFekMsSUFBSSxFQUFFQyxLQUFLLEVBQUUsR0FBRyxNQUFNRixTQUMzQkcsSUFBSSxDQUFDLGlCQUNMQyxNQUFNLENBQUNZLE1BQ1BYLE1BQU07SUFDVCxJQUFJSCxPQUFPLE1BQU1BO0lBQ2pCLE9BQU9EO0FBQ1Q7QUFFTyxlQUFlNkQsaUJBQWlCaEQsV0FBVztJQUNoRCxNQUFNZCxXQUFXUCxnRUFBZ0JBO0lBQ2pDLE1BQU0sRUFBRVEsSUFBSSxFQUFFQyxLQUFLLEVBQUUsR0FBRyxNQUFNRixTQUMzQkcsSUFBSSxDQUFDLGlCQUNMRSxNQUFNLENBQUMsS0FDUE8sRUFBRSxDQUFDLGVBQWVFLGFBQ2xCTixLQUFLLENBQUMsaUJBQWlCO1FBQUVDLFdBQVc7SUFBSztJQUM1QyxJQUFJUCxPQUFPLE1BQU1BO0lBQ2pCLE9BQU9ELFFBQVEsRUFBRTtBQUNuQjtBQUVPLGVBQWU4RDtJQUNwQixNQUFNL0QsV0FBV1AsZ0VBQWdCQTtJQUNqQyxNQUFNLEVBQUVRLE1BQU0rRCxNQUFNLEVBQUU5RCxPQUFPK0QsU0FBUyxFQUFFLEdBQUcsTUFBTWpFLFNBQzlDRyxJQUFJLENBQUMsb0JBQ0xFLE1BQU0sQ0FBQyxxRUFDUEcsS0FBSyxDQUFDLGlCQUFpQjtRQUFFQyxXQUFXO0lBQUs7SUFFNUMsSUFBSXdELFdBQVcsTUFBTUE7SUFFckIsTUFBTSxFQUFFaEUsTUFBTWlFLE9BQU8sRUFBRWhFLE9BQU9pRSxVQUFVLEVBQUUsR0FBRyxNQUFNbkUsU0FDaERHLElBQUksQ0FBQyxpQkFDTEUsTUFBTSxDQUFDLEtBQ1BHLEtBQUssQ0FBQyxpQkFBaUI7UUFBRUMsV0FBVztJQUFLO0lBRTVDLElBQUkwRCxZQUFZLE1BQU1BO0lBRXRCLE9BQU87UUFBRUg7UUFBUUU7SUFBUTtBQUMzQiIsInNvdXJjZXMiOlsid2VicGFjazovL2NpdmljYWktYXV0b3BpbG90Ly4vc3JjL2xpYi9kYi5qcz83ZjlhIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGdldFN1cGFiYXNlQWRtaW4gfSBmcm9tIFwiLi9zdXBhYmFzZUFkbWluXCI7XG5cbi8qKlxuICogU2ltcGxlIERCIGhlbHBlciBmdW5jdGlvbnMgdXNpbmcgU3VwYWJhc2UuXG4gKi9cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUNhbXBhaWduKHsgbmFtZSwgbmljaGUsIHRhcmdldF9kZXNjcmlwdGlvbiwgb2ZmZXIsIHRvbmUgfSkge1xuICBjb25zdCBzdXBhYmFzZSA9IGdldFN1cGFiYXNlQWRtaW4oKTtcbiAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAuZnJvbShcImNhbXBhaWduc1wiKVxuICAgIC5pbnNlcnQoW3sgbmFtZSwgbmljaGUsIHRhcmdldF9kZXNjcmlwdGlvbiwgb2ZmZXIsIHRvbmUgfV0pXG4gICAgLnNlbGVjdCgpXG4gICAgLnNpbmdsZSgpO1xuICBpZiAoZXJyb3IpIHRocm93IGVycm9yO1xuICByZXR1cm4gZGF0YTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGxpc3RDYW1wYWlnbnMoKSB7XG4gIGNvbnN0IHN1cGFiYXNlID0gZ2V0U3VwYWJhc2VBZG1pbigpO1xuICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgIC5mcm9tKFwiY2FtcGFpZ25zXCIpXG4gICAgLnNlbGVjdChcIipcIilcbiAgICAub3JkZXIoXCJjcmVhdGVkX2F0XCIsIHsgYXNjZW5kaW5nOiBmYWxzZSB9KTtcbiAgaWYgKGVycm9yKSB0aHJvdyBlcnJvcjtcbiAgcmV0dXJuIGRhdGEgfHwgW107XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDYW1wYWlnbihpZCkge1xuICBjb25zdCBzdXBhYmFzZSA9IGdldFN1cGFiYXNlQWRtaW4oKTtcbiAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAuZnJvbShcImNhbXBhaWduc1wiKVxuICAgIC5zZWxlY3QoXCIqXCIpXG4gICAgLmVxKFwiaWRcIiwgaWQpXG4gICAgLnNpbmdsZSgpO1xuICBpZiAoZXJyb3IpIHRocm93IGVycm9yO1xuICByZXR1cm4gZGF0YTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNhdmVFbWFpbFRlbXBsYXRlcyhjYW1wYWlnbl9pZCwgdGVtcGxhdGVzKSB7XG4gIGNvbnN0IHN1cGFiYXNlID0gZ2V0U3VwYWJhc2VBZG1pbigpO1xuICBjb25zdCByb3dzID0gT2JqZWN0LmVudHJpZXModGVtcGxhdGVzKS5tYXAoKFt0eXBlLCB0cGxdKSA9PiAoe1xuICAgIGNhbXBhaWduX2lkLFxuICAgIHR5cGUsXG4gICAgc3ViamVjdDogdHBsLnN1YmplY3QsXG4gICAgYm9keTogdHBsLmJvZHlcbiAgfSkpO1xuICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgIC5mcm9tKFwiZW1haWxfdGVtcGxhdGVzXCIpXG4gICAgLmluc2VydChyb3dzKVxuICAgIC5zZWxlY3QoKTtcbiAgaWYgKGVycm9yKSB0aHJvdyBlcnJvcjtcbiAgcmV0dXJuIGRhdGE7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsaXN0RW1haWxUZW1wbGF0ZXMoY2FtcGFpZ25faWQpIHtcbiAgY29uc3Qgc3VwYWJhc2UgPSBnZXRTdXBhYmFzZUFkbWluKCk7XG4gIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgLmZyb20oXCJlbWFpbF90ZW1wbGF0ZXNcIilcbiAgICAuc2VsZWN0KFwiKlwiKVxuICAgIC5lcShcImNhbXBhaWduX2lkXCIsIGNhbXBhaWduX2lkKVxuICAgIC5vcmRlcihcImNyZWF0ZWRfYXRcIiwgeyBhc2NlbmRpbmc6IHRydWUgfSk7XG4gIGlmIChlcnJvcikgdGhyb3cgZXJyb3I7XG4gIHJldHVybiBkYXRhIHx8IFtdO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gYWRkTGVhZHMoY2FtcGFpZ25faWQsIGxlYWRzKSB7XG4gIGNvbnN0IHN1cGFiYXNlID0gZ2V0U3VwYWJhc2VBZG1pbigpO1xuICBjb25zdCByb3dzID0gbGVhZHMubWFwKGwgPT4gKHtcbiAgICBjYW1wYWlnbl9pZCxcbiAgICBuYW1lOiBsLm5hbWUgfHwgbnVsbCxcbiAgICBjb21wYW55OiBsLmNvbXBhbnkgfHwgbnVsbCxcbiAgICBlbWFpbDogbC5lbWFpbCxcbiAgICBleHRyYV9kYXRhOiBsLmV4dHJhX2RhdGEgfHwgbnVsbFxuICB9KSk7XG4gIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgLmZyb20oXCJsZWFkc1wiKVxuICAgIC5pbnNlcnQocm93cylcbiAgICAuc2VsZWN0KCk7XG4gIGlmIChlcnJvcikgdGhyb3cgZXJyb3I7XG4gIHJldHVybiBkYXRhO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbGlzdExlYWRzKGNhbXBhaWduX2lkKSB7XG4gIGNvbnN0IHN1cGFiYXNlID0gZ2V0U3VwYWJhc2VBZG1pbigpO1xuICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgIC5mcm9tKFwibGVhZHNcIilcbiAgICAuc2VsZWN0KFwiKlwiKVxuICAgIC5lcShcImNhbXBhaWduX2lkXCIsIGNhbXBhaWduX2lkKVxuICAgIC5vcmRlcihcImNyZWF0ZWRfYXRcIiwgeyBhc2NlbmRpbmc6IHRydWUgfSk7XG4gIGlmIChlcnJvcikgdGhyb3cgZXJyb3I7XG4gIHJldHVybiBkYXRhIHx8IFtdO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2NoZWR1bGVFbWFpbHMoeyBjYW1wYWlnbl9pZCwgdGVtcGxhdGVfaWRzLCBzZW5kX2Zyb20sIG1heF9wZXJfcnVuID0gNTAgfSkge1xuICBjb25zdCBzdXBhYmFzZSA9IGdldFN1cGFiYXNlQWRtaW4oKTtcblxuICBjb25zdCB7IGRhdGE6IGxlYWRzLCBlcnJvcjogbGVhZEVyciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAuZnJvbShcImxlYWRzXCIpXG4gICAgLnNlbGVjdChcIipcIilcbiAgICAuZXEoXCJjYW1wYWlnbl9pZFwiLCBjYW1wYWlnbl9pZCk7XG4gIGlmIChsZWFkRXJyKSB0aHJvdyBsZWFkRXJyO1xuXG4gIGNvbnN0IHsgZGF0YTogdGVtcGxhdGVzLCBlcnJvcjogdHBsRXJyIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgIC5mcm9tKFwiZW1haWxfdGVtcGxhdGVzXCIpXG4gICAgLnNlbGVjdChcIipcIilcbiAgICAuaW4oXCJpZFwiLCB0ZW1wbGF0ZV9pZHMpO1xuICBpZiAodHBsRXJyKSB0aHJvdyB0cGxFcnI7XG5cbiAgY29uc3Qgc2NoZWR1bGVkUm93cyA9IFtdO1xuICBsZXQgb2Zmc2V0TWludXRlcyA9IDA7XG5cbiAgZm9yIChjb25zdCBsZWFkIG9mIGxlYWRzKSB7XG4gICAgZm9yIChjb25zdCB0cGwgb2YgdGVtcGxhdGVzKSB7XG4gICAgICBjb25zdCBzY2hlZHVsZWRfZm9yID0gbmV3IERhdGUobmV3IERhdGUoc2VuZF9mcm9tKS5nZXRUaW1lKCkgKyBvZmZzZXRNaW51dGVzICogNjAwMDApLnRvSVNPU3RyaW5nKCk7XG4gICAgICBzY2hlZHVsZWRSb3dzLnB1c2goe1xuICAgICAgICBjYW1wYWlnbl9pZCxcbiAgICAgICAgbGVhZF9pZDogbGVhZC5pZCxcbiAgICAgICAgdGVtcGxhdGVfaWQ6IHRwbC5pZCxcbiAgICAgICAgc2NoZWR1bGVkX2ZvcixcbiAgICAgICAgc3RhdHVzOiBcInBlbmRpbmdcIlxuICAgICAgfSk7XG4gICAgICBvZmZzZXRNaW51dGVzICs9IDI7IC8vIGtsZWluZSBkZWxheSB0dXNzZW4gbWFpbHNcbiAgICB9XG4gIH1cblxuICBpZiAoIXNjaGVkdWxlZFJvd3MubGVuZ3RoKSByZXR1cm4gW107XG5cbiAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAuZnJvbShcInNjaGVkdWxlZF9lbWFpbHNcIilcbiAgICAuaW5zZXJ0KHNjaGVkdWxlZFJvd3MpXG4gICAgLnNlbGVjdCgpO1xuICBpZiAoZXJyb3IpIHRocm93IGVycm9yO1xuICByZXR1cm4gZGF0YTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFBlbmRpbmdFbWFpbHMobGltaXQgPSAyMCkge1xuICBjb25zdCBzdXBhYmFzZSA9IGdldFN1cGFiYXNlQWRtaW4oKTtcbiAgY29uc3Qgbm93SXNvID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpO1xuXG4gIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgLmZyb20oXCJzY2hlZHVsZWRfZW1haWxzXCIpXG4gICAgLnNlbGVjdChcIiosIGxlYWRzKCopLCBlbWFpbF90ZW1wbGF0ZXMoKilcIilcbiAgICAuZXEoXCJzdGF0dXNcIiwgXCJwZW5kaW5nXCIpXG4gICAgLmx0ZShcInNjaGVkdWxlZF9mb3JcIiwgbm93SXNvKVxuICAgIC5vcmRlcihcInNjaGVkdWxlZF9mb3JcIiwgeyBhc2NlbmRpbmc6IHRydWUgfSlcbiAgICAubGltaXQobGltaXQpO1xuXG4gIGlmIChlcnJvcikgdGhyb3cgZXJyb3I7XG4gIHJldHVybiBkYXRhIHx8IFtdO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbWFya0VtYWlsQXNTZW50KGlkLCBwcm92aWRlcl9tZXNzYWdlX2lkKSB7XG4gIGNvbnN0IHN1cGFiYXNlID0gZ2V0U3VwYWJhc2VBZG1pbigpO1xuICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgIC5mcm9tKFwic2NoZWR1bGVkX2VtYWlsc1wiKVxuICAgIC51cGRhdGUoe1xuICAgICAgc3RhdHVzOiBcInNlbnRcIixcbiAgICAgIHByb3ZpZGVyX21lc3NhZ2VfaWRcbiAgICB9KVxuICAgIC5lcShcImlkXCIsIGlkKVxuICAgIC5zZWxlY3QoKVxuICAgIC5zaW5nbGUoKTtcbiAgaWYgKGVycm9yKSB0aHJvdyBlcnJvcjtcbiAgcmV0dXJuIGRhdGE7XG59XG5cbi8qKiBDb250ZW50IGl0ZW1zIGZvciBnZW5lcmF0b3IgKyBjYWxlbmRhciAqKi9cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNhdmVDb250ZW50SXRlbXMoY2FtcGFpZ25faWQsIGl0ZW1zKSB7XG4gIGNvbnN0IHN1cGFiYXNlID0gZ2V0U3VwYWJhc2VBZG1pbigpO1xuICBjb25zdCByb3dzID0gaXRlbXMubWFwKGl0ID0+ICh7XG4gICAgY2FtcGFpZ25faWQsXG4gICAgdHlwZTogaXQudHlwZSxcbiAgICB0aXRsZTogaXQudGl0bGUsXG4gICAgYm9keTogaXQuYm9keSxcbiAgICBzY2hlZHVsZWRfZm9yOiBpdC5zY2hlZHVsZWRfZm9yIHx8IG51bGxcbiAgfSkpO1xuICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgIC5mcm9tKFwiY29udGVudF9pdGVtc1wiKVxuICAgIC5pbnNlcnQocm93cylcbiAgICAuc2VsZWN0KCk7XG4gIGlmIChlcnJvcikgdGhyb3cgZXJyb3I7XG4gIHJldHVybiBkYXRhO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbGlzdENvbnRlbnRJdGVtcyhjYW1wYWlnbl9pZCkge1xuICBjb25zdCBzdXBhYmFzZSA9IGdldFN1cGFiYXNlQWRtaW4oKTtcbiAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAuZnJvbShcImNvbnRlbnRfaXRlbXNcIilcbiAgICAuc2VsZWN0KFwiKlwiKVxuICAgIC5lcShcImNhbXBhaWduX2lkXCIsIGNhbXBhaWduX2lkKVxuICAgIC5vcmRlcihcInNjaGVkdWxlZF9mb3JcIiwgeyBhc2NlbmRpbmc6IHRydWUgfSk7XG4gIGlmIChlcnJvcikgdGhyb3cgZXJyb3I7XG4gIHJldHVybiBkYXRhIHx8IFtdO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbGlzdENhbGVuZGFySXRlbXMoKSB7XG4gIGNvbnN0IHN1cGFiYXNlID0gZ2V0U3VwYWJhc2VBZG1pbigpO1xuICBjb25zdCB7IGRhdGE6IGVtYWlscywgZXJyb3I6IGVtYWlsc0VyciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAuZnJvbShcInNjaGVkdWxlZF9lbWFpbHNcIilcbiAgICAuc2VsZWN0KFwiaWQsIHNjaGVkdWxlZF9mb3IsIHN0YXR1cywgbGVhZHMoZW1haWwpLCBlbWFpbF90ZW1wbGF0ZXMoc3ViamVjdClcIilcbiAgICAub3JkZXIoXCJzY2hlZHVsZWRfZm9yXCIsIHsgYXNjZW5kaW5nOiB0cnVlIH0pO1xuXG4gIGlmIChlbWFpbHNFcnIpIHRocm93IGVtYWlsc0VycjtcblxuICBjb25zdCB7IGRhdGE6IGNvbnRlbnQsIGVycm9yOiBjb250ZW50RXJyIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgIC5mcm9tKFwiY29udGVudF9pdGVtc1wiKVxuICAgIC5zZWxlY3QoXCIqXCIpXG4gICAgLm9yZGVyKFwic2NoZWR1bGVkX2ZvclwiLCB7IGFzY2VuZGluZzogdHJ1ZSB9KTtcblxuICBpZiAoY29udGVudEVycikgdGhyb3cgY29udGVudEVycjtcblxuICByZXR1cm4geyBlbWFpbHMsIGNvbnRlbnQgfTtcbn1cbiJdLCJuYW1lcyI6WyJnZXRTdXBhYmFzZUFkbWluIiwiY3JlYXRlQ2FtcGFpZ24iLCJuYW1lIiwibmljaGUiLCJ0YXJnZXRfZGVzY3JpcHRpb24iLCJvZmZlciIsInRvbmUiLCJzdXBhYmFzZSIsImRhdGEiLCJlcnJvciIsImZyb20iLCJpbnNlcnQiLCJzZWxlY3QiLCJzaW5nbGUiLCJsaXN0Q2FtcGFpZ25zIiwib3JkZXIiLCJhc2NlbmRpbmciLCJnZXRDYW1wYWlnbiIsImlkIiwiZXEiLCJzYXZlRW1haWxUZW1wbGF0ZXMiLCJjYW1wYWlnbl9pZCIsInRlbXBsYXRlcyIsInJvd3MiLCJPYmplY3QiLCJlbnRyaWVzIiwibWFwIiwidHlwZSIsInRwbCIsInN1YmplY3QiLCJib2R5IiwibGlzdEVtYWlsVGVtcGxhdGVzIiwiYWRkTGVhZHMiLCJsZWFkcyIsImwiLCJjb21wYW55IiwiZW1haWwiLCJleHRyYV9kYXRhIiwibGlzdExlYWRzIiwic2NoZWR1bGVFbWFpbHMiLCJ0ZW1wbGF0ZV9pZHMiLCJzZW5kX2Zyb20iLCJtYXhfcGVyX3J1biIsImxlYWRFcnIiLCJ0cGxFcnIiLCJpbiIsInNjaGVkdWxlZFJvd3MiLCJvZmZzZXRNaW51dGVzIiwibGVhZCIsInNjaGVkdWxlZF9mb3IiLCJEYXRlIiwiZ2V0VGltZSIsInRvSVNPU3RyaW5nIiwicHVzaCIsImxlYWRfaWQiLCJ0ZW1wbGF0ZV9pZCIsInN0YXR1cyIsImxlbmd0aCIsImdldFBlbmRpbmdFbWFpbHMiLCJsaW1pdCIsIm5vd0lzbyIsImx0ZSIsIm1hcmtFbWFpbEFzU2VudCIsInByb3ZpZGVyX21lc3NhZ2VfaWQiLCJ1cGRhdGUiLCJzYXZlQ29udGVudEl0ZW1zIiwiaXRlbXMiLCJpdCIsInRpdGxlIiwibGlzdENvbnRlbnRJdGVtcyIsImxpc3RDYWxlbmRhckl0ZW1zIiwiZW1haWxzIiwiZW1haWxzRXJyIiwiY29udGVudCIsImNvbnRlbnRFcnIiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./src/lib/db.js\n");

/***/ }),

/***/ "(api)/./src/lib/supabaseAdmin.js":
/*!**********************************!*\
  !*** ./src/lib/supabaseAdmin.js ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getSupabaseAdmin: () => (/* binding */ getSupabaseAdmin)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/supabase-js */ \"@supabase/supabase-js\");\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__);\n\nlet supabase = null;\nfunction getSupabaseAdmin() {\n    if (supabase) return supabase;\n    const url = process.env.SUPABASE_URL;\n    const key = process.env.SUPABASE_SERVICE_ROLE_KEY;\n    if (!url || !key) {\n        throw new Error(\"Supabase admin env vars not set (SUPABASE_URL, SUPABASE_SERVICE_ROLE_KEY)\");\n    }\n    supabase = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(url, key);\n    return supabase;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9zcmMvbGliL3N1cGFiYXNlQWRtaW4uanMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQXFEO0FBRXJELElBQUlDLFdBQVc7QUFFUixTQUFTQztJQUNkLElBQUlELFVBQVUsT0FBT0E7SUFFckIsTUFBTUUsTUFBTUMsUUFBUUMsR0FBRyxDQUFDQyxZQUFZO0lBQ3BDLE1BQU1DLE1BQU1ILFFBQVFDLEdBQUcsQ0FBQ0cseUJBQXlCO0lBRWpELElBQUksQ0FBQ0wsT0FBTyxDQUFDSSxLQUFLO1FBQ2hCLE1BQU0sSUFBSUUsTUFBTTtJQUNsQjtJQUVBUixXQUFXRCxtRUFBWUEsQ0FBQ0csS0FBS0k7SUFDN0IsT0FBT047QUFDVCIsInNvdXJjZXMiOlsid2VicGFjazovL2NpdmljYWktYXV0b3BpbG90Ly4vc3JjL2xpYi9zdXBhYmFzZUFkbWluLmpzPzIxZGUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3JlYXRlQ2xpZW50IH0gZnJvbSBcIkBzdXBhYmFzZS9zdXBhYmFzZS1qc1wiO1xuXG5sZXQgc3VwYWJhc2UgPSBudWxsO1xuXG5leHBvcnQgZnVuY3Rpb24gZ2V0U3VwYWJhc2VBZG1pbigpIHtcbiAgaWYgKHN1cGFiYXNlKSByZXR1cm4gc3VwYWJhc2U7XG5cbiAgY29uc3QgdXJsID0gcHJvY2Vzcy5lbnYuU1VQQUJBU0VfVVJMO1xuICBjb25zdCBrZXkgPSBwcm9jZXNzLmVudi5TVVBBQkFTRV9TRVJWSUNFX1JPTEVfS0VZO1xuXG4gIGlmICghdXJsIHx8ICFrZXkpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJTdXBhYmFzZSBhZG1pbiBlbnYgdmFycyBub3Qgc2V0IChTVVBBQkFTRV9VUkwsIFNVUEFCQVNFX1NFUlZJQ0VfUk9MRV9LRVkpXCIpO1xuICB9XG5cbiAgc3VwYWJhc2UgPSBjcmVhdGVDbGllbnQodXJsLCBrZXkpO1xuICByZXR1cm4gc3VwYWJhc2U7XG59XG4iXSwibmFtZXMiOlsiY3JlYXRlQ2xpZW50Iiwic3VwYWJhc2UiLCJnZXRTdXBhYmFzZUFkbWluIiwidXJsIiwicHJvY2VzcyIsImVudiIsIlNVUEFCQVNFX1VSTCIsImtleSIsIlNVUEFCQVNFX1NFUlZJQ0VfUk9MRV9LRVkiLCJFcnJvciJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./src/lib/supabaseAdmin.js\n");

/***/ }),

/***/ "(api)/./src/pages/api/campaigns/list.js":
/*!*****************************************!*\
  !*** ./src/pages/api/campaigns/list.js ***!
  \*****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _lib_db__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/db */ \"(api)/./src/lib/db.js\");\n\nasync function handler(req, res) {\n    if (req.method !== \"GET\") return res.status(405).end();\n    try {\n        const campaigns = await (0,_lib_db__WEBPACK_IMPORTED_MODULE_0__.listCampaigns)();\n        res.status(200).json(campaigns);\n    } catch (err) {\n        console.error(\"list campaigns error\", err);\n        res.status(500).json({\n            error: err.message\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9zcmMvcGFnZXMvYXBpL2NhbXBhaWducy9saXN0LmpzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQWdEO0FBRWpDLGVBQWVDLFFBQVFDLEdBQUcsRUFBRUMsR0FBRztJQUM1QyxJQUFJRCxJQUFJRSxNQUFNLEtBQUssT0FBTyxPQUFPRCxJQUFJRSxNQUFNLENBQUMsS0FBS0MsR0FBRztJQUVwRCxJQUFJO1FBQ0YsTUFBTUMsWUFBWSxNQUFNUCxzREFBYUE7UUFDckNHLElBQUlFLE1BQU0sQ0FBQyxLQUFLRyxJQUFJLENBQUNEO0lBQ3ZCLEVBQUUsT0FBT0UsS0FBSztRQUNaQyxRQUFRQyxLQUFLLENBQUMsd0JBQXdCRjtRQUN0Q04sSUFBSUUsTUFBTSxDQUFDLEtBQUtHLElBQUksQ0FBQztZQUFFRyxPQUFPRixJQUFJRyxPQUFPO1FBQUM7SUFDNUM7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL2NpdmljYWktYXV0b3BpbG90Ly4vc3JjL3BhZ2VzL2FwaS9jYW1wYWlnbnMvbGlzdC5qcz9lMWM2Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGxpc3RDYW1wYWlnbnMgfSBmcm9tIFwiLi4vLi4vLi4vbGliL2RiXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZXIocmVxLCByZXMpIHtcbiAgaWYgKHJlcS5tZXRob2QgIT09IFwiR0VUXCIpIHJldHVybiByZXMuc3RhdHVzKDQwNSkuZW5kKCk7XG5cbiAgdHJ5IHtcbiAgICBjb25zdCBjYW1wYWlnbnMgPSBhd2FpdCBsaXN0Q2FtcGFpZ25zKCk7XG4gICAgcmVzLnN0YXR1cygyMDApLmpzb24oY2FtcGFpZ25zKTtcbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgY29uc29sZS5lcnJvcihcImxpc3QgY2FtcGFpZ25zIGVycm9yXCIsIGVycik7XG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogZXJyLm1lc3NhZ2UgfSk7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJsaXN0Q2FtcGFpZ25zIiwiaGFuZGxlciIsInJlcSIsInJlcyIsIm1ldGhvZCIsInN0YXR1cyIsImVuZCIsImNhbXBhaWducyIsImpzb24iLCJlcnIiLCJjb25zb2xlIiwiZXJyb3IiLCJtZXNzYWdlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./src/pages/api/campaigns/list.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fcampaigns%2Flist&preferredRegion=&absolutePagePath=.%2Fsrc%5Cpages%5Capi%5Ccampaigns%5Clist.js&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();